<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configuración de Voz - IA Receptionist</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Toastr CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">
    <!-- Select2 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/dashboard.css">
</head>
<body class="bg-light">
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container-fluid">
            <a class="navbar-brand fw-bold" href="dashboard.html">
                <i class="fas fa-robot me-2"></i>IA Receptionist
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarContent">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-bs-toggle="dropdown">
                            <i class="fas fa-user-circle me-1"></i> <span id="username">Usuario</span>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li><a class="dropdown-item" href="profile.html"><i class="fas fa-user me-2"></i>Perfil</a></li>
                            <li><a class="dropdown-item" href="settings.html"><i class="fas fa-cog me-2"></i>Configuración</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="#" id="logout-btn"><i class="fas fa-sign-out-alt me-2"></i>Cerrar sesión</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar -->
            <nav id="sidebar" class="col-md-3 col-lg-2 d-md-block bg-dark sidebar collapse">
                <div class="position-sticky">
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link text-white" href="dashboard.html">
                                <i class="fas fa-home me-2"></i> Dashboard
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-white" href="calls.html">
                                <i class="fas fa-phone me-2"></i> Llamadas
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-white" href="emails.html">
                                <i class="fas fa-envelope me-2"></i> Emails
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active text-white" href="voice-settings.html">
                                <i class="fas fa-microphone me-2"></i> Configuración de Voz
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-white" href="settings.html">
                                <i class="fas fa-cog me-2"></i> Configuración General
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- Main area -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4 py-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center mb-4">
                    <h1><i class="fas fa-microphone me-2"></i>Configuración de Voz y Llamadas</h1>
                </div>

                <!-- Loader -->
                <div id="loading-indicator" class="text-center my-5 d-none">
                    <div class="spinner-border text-primary" role="status"></div>
                    <p class="mt-2 text-muted">Cargando configuración...</p>
                </div>

                <!-- Content container -->
                <div id="content-container">
                    <!-- Tabs -->
                    <ul class="nav nav-tabs" id="configTabs" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="voice-tab" data-bs-toggle="tab" data-bs-target="#voice" type="button" role="tab">
                                <i class="fas fa-volume-up me-1"></i> Configuración de Voz
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="call-tab" data-bs-toggle="tab" data-bs-target="#call" type="button" role="tab">
                                <i class="fas fa-phone-alt me-1"></i> Mensajes de Llamada
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="phone-tab" data-bs-toggle="tab" data-bs-target="#phone" type="button" role="tab">
                                <i class="fas fa-sim-card me-1"></i> Gestión de Números
                            </button>
                        </li>
                    </ul>
                    
                    <div class="tab-content p-4 bg-white border border-top-0 rounded-bottom shadow-sm" id="configTabsContent">
                        <!-- Voice Configuration Tab -->
                        <div class="tab-pane fade show active" id="voice" role="tabpanel" aria-labelledby="voice-tab">
                            <h4 class="mb-4">Selección de Voz</h4>
                            
                            <div class="alert alert-info">
                                <i class="fas fa-info-circle me-2"></i> Selecciona la voz que usará tu asistente virtual para responder llamadas.
                            </div>
                            
                            <div class="mb-4">
                                <label for="voice-selection" class="form-label">Voz del Asistente</label>
                                <select class="form-select select2" id="voice-selection">
                                    <option value="">Cargando voces...</option>
                                </select>
                                <small class="form-text text-muted">Esta voz se usará para todas las respuestas automáticas en llamadas.</small>
                            </div>
                            
                            <div class="mb-4">
                                <label class="form-label">Previsualizar voz</label>
                                <div class="input-group mb-3">
                                    <input type="text" class="form-control" id="preview-text" placeholder="Texto para previsualizar la voz" value="Hola, soy el asistente virtual de tu empresa. ¿En qué puedo ayudarte?">
                                    <button class="btn btn-primary" id="preview-btn" type="button">
                                        <i class="fas fa-play me-1"></i> Reproducir
                                    </button>
                                </div>
                                <div id="audio-player-container" class="d-none">
                                    <audio id="preview-player" controls class="w-100"></audio>
                                </div>
                            </div>
                            
                            <div class="mb-4">
                                <label class="form-label">Idioma</label>
                                <select class="form-select" id="language-selection">
                                    <option value="es-ES">Español (España)</option>
                                    <option value="es-MX">Español (México)</option>
                                    <option value="en-US">Inglés (Estados Unidos)</option>
                                    <option value="en-GB">Inglés (Reino Unido)</option>
                                    <option value="fr-FR">Francés</option>
                                    <option value="de-DE">Alemán</option>
                                    <option value="it-IT">Italiano</option>
                                </select>
                                <small class="form-text text-muted">Idioma para el reconocimiento de voz y síntesis de respuestas.</small>
                            </div>
                            
                            <button id="save-voice-settings" class="btn btn-primary">
                                <i class="fas fa-save me-1"></i> Guardar Configuración
                            </button>
                        </div>
                        
                        <!-- Call Messages Tab -->
                        <div class="tab-pane fade" id="call" role="tabpanel" aria-labelledby="call-tab">
                            <h4 class="mb-4">Mensajes de Llamada</h4>
                            
                            <div class="alert alert-info">
                                <i class="fas fa-info-circle me-2"></i> Personaliza los mensajes que tu asistente virtual utilizará durante las llamadas.
                            </div>
                            
                            <div class="mb-4">
                                <label for="welcome-message" class="form-label">Mensaje de Bienvenida</label>
                                <textarea class="form-control" id="welcome-message" rows="3" placeholder="Gracias por llamar a [Nombre de Empresa]. ¿En qué podemos ayudarle hoy?"></textarea>
                                <small class="form-text text-muted">Este mensaje se reproduce al inicio de cada llamada.</small>
                            </div>
                            
                            <div class="mb-4">
                                <label for="gather-prompt" class="form-label">Solicitud de Información</label>
                                <textarea class="form-control" id="gather-prompt" rows="3" placeholder="Por favor, indique su nombre y el motivo de su llamada después del tono."></textarea>
                                <small class="form-text text-muted">Este mensaje se reproduce cuando se solicita información al llamante.</small>
                            </div>
                            
                            <div class="mb-4">
                                <label for="retry-prompt" class="form-label">Mensaje de Reintento</label>
                                <textarea class="form-control" id="retry-prompt" rows="3" placeholder="No he podido entenderle. Por favor, intente de nuevo."></textarea>
                                <small class="form-text text-muted">Este mensaje se reproduce cuando no se detecta entrada del usuario.</small>
                            </div>
                            
                            <div class="mb-4">
                                <label for="followup-prompt" class="form-label">Mensaje de Seguimiento</label>
                                <textarea class="form-control" id="followup-prompt" rows="3" placeholder="¿Hay algo más que le gustaría añadir? Por favor, indique un número de contacto si desea que nos comuniquemos con usted."></textarea>
                                <small class="form-text text-muted">Este mensaje se reproduce después de la primera respuesta del usuario.</small>
                            </div>
                            
                            <div class="mb-4">
                                <label for="goodbye-message" class="form-label">Mensaje de Despedida</label>
                                <textarea class="form-control" id="goodbye-message" rows="3" placeholder="Gracias por contactar con nosotros. Su mensaje ha sido registrado y nos pondremos en contacto con usted lo antes posible."></textarea>
                                <small class="form-text text-muted">Este mensaje se reproduce al finalizar la llamada.</small>
                            </div>
                            
                            <button id="save-call-settings" class="btn btn-primary">
                                <i class="fas fa-save me-1"></i> Guardar Mensajes
                            </button>
                        </div>
                        
                        <!-- Phone Numbers Tab -->
                        <div class="tab-pane fade" id="phone" role="tabpanel" aria-labelledby="phone-tab">
                            <h4 class="mb-4">Gestión de Números</h4>
                            
                            <div class="alert alert-info">
                                <i class="fas fa-info-circle me-2"></i> Administra los números de teléfono que utilizará tu asistente virtual.
                            </div>
                            
                            <div id="phone-list" class="mb-4">
                                <h5 class="border-bottom pb-2">Números Actuales</h5>
                                <div class="phone-numbers-container">
                                    <div class="text-center my-4" id="phone-loading">
                                        <div class="spinner-border spinner-border-sm text-primary" role="status"></div>
                                        <span class="ms-2">Cargando números...</span>
                                    </div>
                                    <div id="phone-numbers-list">
                                        <!-- Phone numbers will be loaded here -->
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card mb-4">
                                <div class="card-header">
                                    <h5 class="mb-0">Adquirir Nuevo Número</h5>
                                </div>
                                <div class="card-body">
                                    <div class="mb-3">
                                        <label for="area-code" class="form-label">Código de País/Área</label>
                                        <input type="text" class="form-control" id="area-code" placeholder="34" value="34">
                                        <small class="form-text text-muted">Por defecto 34 para España.</small>
                                    </div>
                                    
                                    <div class="mb-3 form-check">
                                        <input type="checkbox" class="form-check-input" id="voice-capability" checked>
                                        <label class="form-check-label" for="voice-capability">Capacidad de Voz</label>
                                    </div>
                                    
                                    <div class="mb-3 form-check">
                                        <input type="checkbox" class="form-check-input" id="sms-capability">
                                        <label class="form-check-label" for="sms-capability">Capacidad de SMS</label>
                                    </div>
                                    
                                    <button id="purchase-number" class="btn btn-success">
                                        <i class="fas fa-plus-circle me-1"></i> Adquirir Número
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Scripts JS -->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="vendor/jquery-easing/jquery.easing.min.js"></script>
    <script src="vendor/toastr/toastr.min.js"></script>
    <script src="vendor/select2/select2.min.js"></script>
    
    <!-- Servicios de autenticación -->
    <script src="js/auth-service.js"></script>
    <script src="js/route-protection.js"></script>
    
    <script>
        // URL base para las llamadas a la API
        const API_BASE_URL = 'http://localhost:3000/api';
    </script>
    
    <!-- Voice Settings Module -->
    <script src="js/voice-settings.js"></script>
</body>
</html>
